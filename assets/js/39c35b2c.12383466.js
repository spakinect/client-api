"use strict";(globalThis.webpackChunkclient_api=globalThis.webpackChunkclient_api||[]).push([[782],{8453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>o});var r=n(6540);const s={},i=r.createContext(s);function d(e){const t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:t},e.children)}},8818:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"webhooks","title":"Webhook Events","description":"Spakinect can send webhook notifications to your system when specific events occur. This allows you to receive real-time updates about visits and treatments without polling the API.","source":"@site/docs/webhooks.md","sourceDirName":".","slug":"/webhooks","permalink":"/client-api/webhooks","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"webhooks","title":"Webhook Events","sidebar_position":2}}');var s=n(4848),i=n(8453);const d={id:"webhooks",title:"Webhook Events",sidebar_position:2},o="Webhook Events",l={},c=[{value:"Configuration",id:"configuration",level:2},{value:"Webhook Security",id:"webhook-security",level:2},{value:"Supported Events",id:"supported-events",level:2},{value:"1. Visit Completed (<code>visit.completed</code>)",id:"1-visit-completed-visitcompleted",level:3},{value:"Payload Structure",id:"payload-structure",level:4},{value:"Payload Fields",id:"payload-fields",level:4},{value:"Example Handler (Node.js/Express)",id:"example-handler-nodejsexpress",level:4}];function a(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"webhook-events",children:"Webhook Events"})}),"\n",(0,s.jsx)(t.p,{children:"Spakinect can send webhook notifications to your system when specific events occur. This allows you to receive real-time updates about visits and treatments without polling the API."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(t.p,{children:"To receive webhook notifications, you need to:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Contact the Spakinect team"})," to configure webhook URLs for your Client account"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Provide your endpoint URLs"})," for each event type you want to subscribe to"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Implement webhook handlers"})," that can receive and process POST requests from Spakinect"]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"webhook-security",children:"Webhook Security"}),"\n",(0,s.jsx)(t.p,{children:"All webhook requests from Spakinect include:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Content-Type"}),": ",(0,s.jsx)(t.code,{children:"application/json"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"User-Agent"}),": ",(0,s.jsx)(t.code,{children:"Spakinect-Webhook/1.0"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Your webhook endpoint should:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Respond with a ",(0,s.jsx)(t.code,{children:"200 OK"})," status code to acknowledge receipt"]}),"\n",(0,s.jsx)(t.li,{children:"Process the webhook asynchronously to avoid timeouts"}),"\n",(0,s.jsx)(t.li,{children:"Implement retry logic in case of temporary failures on your end"}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"supported-events",children:"Supported Events"}),"\n",(0,s.jsxs)(t.h3,{id:"1-visit-completed-visitcompleted",children:["1. Visit Completed (",(0,s.jsx)(t.code,{children:"visit.completed"}),")"]}),"\n",(0,s.jsx)(t.p,{children:"Triggered when a Good Faith Exam (GFE) visit is completed and all treatment decisions have been made."}),"\n",(0,s.jsx)(t.h4,{id:"payload-structure",children:"Payload Structure"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\r\n  "event": "visit.completed",\r\n  "timestamp": 1714675200000,\r\n  "success": true,\r\n  "data": {\r\n    "location_id": "loc_12345",\r\n    "gfe_id": "gfe_abc123xyz789",\r\n    "status": "Completed",\r\n    "pdf_link": "https://example-cdn.com/gfe/gfe_abc123xyz789.pdf",\r\n    "requested_treatments": [\r\n      "Botox Injection",\r\n      "Dermal Filler"\r\n    ],\r\n    "approved_treatments": [\r\n      "Botox Injection"\r\n    ],\r\n    "conditionally_approved_treatments": [\r\n      "Dermal Filler"\r\n    ],\r\n    "deferred_treatments": [],\r\n    "patient_details": {\r\n      "name": "Jane Smith",\r\n      "first_name": "Jane",\r\n      "last_name": "Smith",\r\n      "email": "jane.smith@example.com"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,s.jsx)(t.h4,{id:"payload-fields",children:"Payload Fields"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Field"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"event"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsxs)(t.td,{children:["Always ",(0,s.jsx)(t.code,{children:'"visit.completed"'})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"timestamp"})}),(0,s.jsx)(t.td,{children:"integer"}),(0,s.jsx)(t.td,{children:"Unix timestamp in milliseconds when the event occurred"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"success"})}),(0,s.jsx)(t.td,{children:"boolean"}),(0,s.jsx)(t.td,{children:"Indicates if the data retrieval was successful"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.location_id"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"The ID of the location where the visit took place"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.gfe_id"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"Unique identifier for the GFE visit"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.status"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsxs)(t.td,{children:["Visit status (always ",(0,s.jsx)(t.code,{children:'"Completed"'})," for this event)"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.pdf_link"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"URL to download the GFE PDF (if available)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.requested_treatments"})}),(0,s.jsx)(t.td,{children:"array"}),(0,s.jsx)(t.td,{children:"List of treatment names originally requested"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.approved_treatments"})}),(0,s.jsx)(t.td,{children:"array"}),(0,s.jsx)(t.td,{children:"List of treatment names that were approved"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.conditionally_approved_treatments"})}),(0,s.jsx)(t.td,{children:"array"}),(0,s.jsx)(t.td,{children:"List of treatment names with conditional approval"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.deferred_treatments"})}),(0,s.jsx)(t.td,{children:"array"}),(0,s.jsx)(t.td,{children:"List of treatment names that were deferred"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.patient_details"})}),(0,s.jsx)(t.td,{children:"object"}),(0,s.jsx)(t.td,{children:"Patient information"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.patient_details.name"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"Patient's full name"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.patient_details.first_name"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"Patient's first name"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.patient_details.last_name"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"Patient's last name"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"data.patient_details.email"})}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"Patient's email address"})]})]})]}),"\n",(0,s.jsx)(t.h4,{id:"example-handler-nodejsexpress",children:"Example Handler (Node.js/Express)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"app.post('/webhooks/visit-completed', async (req, res) => {\r\n  try {\r\n    const { event, data } = req.body;\r\n    \r\n    // Verify event type\r\n    if (event !== 'visit.completed') {\r\n      return res.status(400).json({ error: 'Invalid event type' });\r\n    }\r\n    \r\n    // Process the webhook data\r\n    console.log(`Visit ${data.gfe_id} completed for location ${data.location_id}`);\r\n    console.log(`Approved treatments:`, data.approved_treatments);\r\n    \r\n    // Update your system with the results\r\n    await updateVisitInYourSystem(data);\r\n    \r\n    // Respond quickly to acknowledge receipt\r\n    res.status(200).json({ received: true });\r\n    \r\n  } catch (error) {\r\n    console.error('Webhook processing error:', error);\r\n    res.status(500).json({ error: 'Internal server error' });\r\n  }\r\n});\n"})}),"\n",(0,s.jsx)(t.hr,{})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);